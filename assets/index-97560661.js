var V=function(){return V=Object.assign||function(t){for(var i,e=1,o=arguments.length;e<o;e++)for(var p in i=arguments[e])Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p]);return t},V.apply(this,arguments)};function ut(t,i,e){if(e||arguments.length===2)for(var o,p=0,a=i.length;p<a;p++)!o&&p in i||(o||(o=Array.prototype.slice.call(i,0,p)),o[p]=i[p]);return t.concat(o||Array.prototype.slice.call(i))}function nt(t){return Array.prototype.slice.call(t)}function rt(t,i){var e=Math.floor(t);return e===i||e+1===i?t:i}function at(){return Date.now()}function Q(t,i,e){if(i="data-keen-slider-"+i,e===null)return t.removeAttribute(i);t.setAttribute(i,e||"")}function K(t,i){return i=i||document,typeof t=="function"&&(t=t(i)),Array.isArray(t)?t:typeof t=="string"?nt(i.querySelectorAll(t)):t instanceof HTMLElement?[t]:t instanceof NodeList?nt(t):[]}function $(t){t.raw&&(t=t.raw),t.cancelable&&!t.defaultPrevented&&t.preventDefault()}function B(t){t.raw&&(t=t.raw),t.stopPropagation&&t.stopPropagation()}function st(){var t=[];return{add:function(i,e,o,p){i.addListener?i.addListener(o):i.addEventListener(e,o,p),t.push([i,e,o,p])},input:function(i,e,o,p){this.add(i,e,function(a){return function(r){r.nativeEvent&&(r=r.nativeEvent);var k=r.changedTouches||[],w=r.targetTouches||[],d=r.detail&&r.detail.x?r.detail:null;return a({id:d?d.identifier?d.identifier:"i":w[0]?w[0]?w[0].identifier:"e":"d",idChanged:d?d.identifier?d.identifier:"i":k[0]?k[0]?k[0].identifier:"e":"d",raw:r,x:d&&d.x?d.x:w[0]?w[0].screenX:d?d.x:r.pageX,y:d&&d.y?d.y:w[0]?w[0].screenY:d?d.y:r.pageY})}}(o),p)},purge:function(){t.forEach(function(i){i[0].removeListener?i[0].removeListener(i[2]):i[0].removeEventListener(i[1],i[2],i[3])}),t=[]}}}function Z(t,i,e){return Math.min(Math.max(t,i),e)}function X(t){return(t>0?1:0)-(t<0?1:0)||+t}function ot(t){var i=t.getBoundingClientRect();return{height:rt(i.height,t.offsetHeight),width:rt(i.width,t.offsetWidth)}}function R(t,i,e,o){var p=t&&t[i];return p==null?e:o&&typeof p=="function"?p():p}function W(t){return Math.round(1e6*t)/1e6}function lt(t){var i,e,o,p,a,r;function k(M){r||(r=M),w(!0);var C=M-r;C>o&&(C=o);var v=p[e];if(v[3]<C)return e++,k(M);var T=v[2],S=v[4],h=v[0],m=v[1]*(0,v[5])(S===0?1:(C-T)/S);if(m&&t.track.to(h+m),C<o)return E();r=null,w(!1),d(null),t.emit("animationEnded")}function w(M){i.active=M}function d(M){i.targetIdx=M}function E(){var M;M=k,a=window.requestAnimationFrame(M)}function z(){var M;M=a,window.cancelAnimationFrame(M),w(!1),d(null),r&&t.emit("animationStopped"),r=null}return i={active:!1,start:function(M){if(z(),t.track.details){var C=0,v=t.track.details.position;e=0,o=0,p=M.map(function(T){var S,h=Number(v),m=(S=T.earlyExit)!==null&&S!==void 0?S:T.duration,f=T.easing,O=T.distance*f(m/T.duration)||0;v+=O;var L=o;return o+=m,C+=O,[h,T.distance,L,o,T.duration,f]}),d(t.track.distToIdx(C)),E(),t.emit("animationStarted")}},stop:z,targetIdx:null}}function ft(t){var i,e,o,p,a,r,k,w,d,E,z,M,C,v,T=1/0,S=[],h=null,m=0;function f(l){j(m+l)}function O(l){var s=L(m+l).abs;return x(s)?s:null}function L(l){var s=Math.floor(Math.abs(W(l/e))),n=W((l%e+e)%e);n===e&&(n=0);var b=X(l),c=k.indexOf(ut([],k,!0).reduce(function(I,A){return Math.abs(A-n)<Math.abs(I-n)?A:I})),y=c;return b<0&&s++,c===r&&(y=0,s+=b>0?1:-1),{abs:y+s*r*b,origin:c,rel:y}}function D(l,s,n){var b;if(s||!U())return u(l,n);if(!x(l))return null;var c=L(n??m),y=c.abs,I=l-c.rel,A=y+I;b=u(A);var q=u(A-r*X(I));return(q!==null&&Math.abs(q)<Math.abs(b)||b===null)&&(b=q),W(b)}function u(l,s){if(s==null&&(s=W(m)),!x(l)||l===null)return null;l=Math.round(l);var n=L(s),b=n.abs,c=n.rel,y=n.origin,I=P(l),A=(s%e+e)%e,q=k[y],F=Math.floor((l-(b-c))/r)*e;return W(q-A-q+k[I]+F+(y===r?e:0))}function x(l){return H(l)===l}function H(l){return Z(l,d,E)}function U(){return p.loop}function P(l){return(l%r+r)%r}function j(l){var s;s=l-m,S.push({distance:s,timestamp:at()}),S.length>6&&(S=S.slice(-6)),m=W(l);var n=g().abs;if(n!==h){var b=h!==null;h=n,b&&t.emit("slideChanged")}}function g(l){var s=l?null:function(){if(r){var n=U(),b=n?(m%e+e)%e:m,c=(n?m%e:m)-a[0][2],y=0-(c<0&&n?e-Math.abs(c):c),I=0,A=L(m),q=A.abs,F=A.rel,J=a[F][2],G=a.map(function(N,ct){var _=y+I;(_<0-N[0]||_>1)&&(_+=(Math.abs(_)>e-1&&n?e:0)*X(-_));var tt=ct-F,et=X(tt),Y=tt+q;n&&(et===-1&&_>J&&(Y+=r),et===1&&_<J&&(Y-=r),z!==null&&Y<z&&(_+=e),M!==null&&Y>M&&(_-=e));var it=_+N[0]+N[1],dt=Math.max(_>=0&&it<=1?1:it<0||_>1?0:_<0?Math.min(1,(N[0]+_)/N[0]):(1-_)/N[0],0);return I+=N[0]+N[1],{abs:Y,distance:p.rtl?-1*_+1-N[0]:_,portion:dt,size:N[0]}});return q=H(q),F=P(q),{abs:H(q),length:o,max:v,maxIdx:E,min:C,minIdx:d,position:m,progress:n?b/e:m/o,rel:F,slides:G,slidesLength:e}}}();return i.details=s,t.emit("detailsChanged"),s}return i={absToRel:P,add:f,details:null,distToIdx:O,idxToDist:D,init:function(l){if(function(){if(p=t.options,a=(p.trackConfig||[]).map(function(c){return[R(c,"size",1),R(c,"spacing",0),R(c,"origin",0)]}),r=a.length){e=W(a.reduce(function(c,y){return c+y[0]+y[1]},0));var n,b=r-1;o=W(e+a[0][2]-a[b][0]-a[b][2]-a[b][1]),k=a.reduce(function(c,y){if(!c)return[0];var I=a[c.length-1],A=c[c.length-1]+(I[0]+I[2])+I[1];return A-=y[2],c[c.length-1]>A&&(A=c[c.length-1]),A=W(A),c.push(A),(!n||n<A)&&(w=c.length-1),n=A,c},null),o===0&&(w=0),k.push(W(e))}}(),!r)return g(!0);var s;(function(){var n=t.options.range,b=t.options.loop;z=d=b?R(b,"min",-1/0):0,M=E=b?R(b,"max",T):w;var c=R(n,"min",null),y=R(n,"max",null);c!==null&&(d=c),y!==null&&(E=y),C=d===-1/0?d:t.track.idxToDist(d||0,!0,0),v=E===T?E:D(E,!0,0),y===null&&(M=E),R(n,"align",!1)&&E!==T&&a[P(E)][2]===0&&(v-=1-a[P(E)][0],E=O(v-m)),C=W(C),v=W(v)})(),s=l,Number(s)===s?f(u(H(l))):g()},to:j,velocity:function(){var l=at(),s=S.reduce(function(n,b){var c=b.distance,y=b.timestamp;return l-y>200||(X(c)!==X(n.distance)&&n.distance&&(n={distance:0,lastTimestamp:0,time:0}),n.time&&(n.distance+=c),n.lastTimestamp&&(n.time+=y-n.lastTimestamp),n.lastTimestamp=y),n},{distance:0,lastTimestamp:0,time:0});return s.distance/s.time||0}}}function pt(t){var i,e,o,p,a,r,k,w;function d(h){return 2*h}function E(h){return Z(h,k,w)}function z(h){return 1-Math.pow(1-h,3)}function M(){return o?t.track.velocity():0}function C(){S();var h=t.options.mode==="free-snap",m=t.track,f=M();p=X(f);var O=t.track.details,L=[];if(f||!h){var D=v(f),u=D.dist,x=D.dur;if(x=d(x),u*=p,h){var H=m.idxToDist(m.distToIdx(u),!0);H&&(u=H)}L.push({distance:u,duration:x,easing:z});var U=O.position,P=U+u;if(P<a||P>r){var j=P<a?a-U:r-U,g=0,l=f;if(X(j)===p){var s=Math.min(Math.abs(j)/Math.abs(u),1),n=function(y){return 1-Math.pow(1-y,1/3)}(s)*x;L[0].earlyExit=n,l=f*(1-s)}else L[0].earlyExit=0,g+=j;var b=v(l,100),c=b.dist*p;t.options.rubberband&&(L.push({distance:c,duration:d(b.dur),easing:z}),L.push({distance:-c+g,duration:500,easing:z}))}t.animator.start(L)}else t.moveToIdx(E(O.abs),!0,{duration:500,easing:function(y){return 1+--y*y*y*y*y}})}function v(h,m){m===void 0&&(m=1e3);var f=147e-9+(h=Math.abs(h))/m;return{dist:Math.pow(h,2)/f,dur:h/f}}function T(){var h=t.track.details;h&&(a=h.min,r=h.max,k=h.minIdx,w=h.maxIdx)}function S(){t.animator.stop()}t.on("updated",T),t.on("optionsChanged",T),t.on("created",T),t.on("dragStarted",function(){o=!1,S(),i=e=t.track.details.abs}),t.on("dragChecked",function(){o=!0}),t.on("dragEnded",function(){var h=t.options.mode;h==="snap"&&function(){var m=t.track,f=t.track.details,O=f.position,L=X(M());(O>r||O<a)&&(L=0);var D=i+L;f.slides[m.absToRel(D)].portion===0&&(D-=L),i!==e&&(D=e),X(m.idxToDist(D,!0))!==L&&(D+=L),D=E(D);var u=m.idxToDist(D,!0);t.animator.start([{distance:u,duration:500,easing:function(x){return 1+--x*x*x*x*x}}])}(),h!=="free"&&h!=="free-snap"||C()}),t.on("dragged",function(){e=t.track.details.abs})}function vt(t){var i,e,o,p,a,r,k,w,d,E,z,M,C,v,T,S,h,m,f=st();function O(g){if(r&&w===g.id){var l=x(g);if(d){if(!u(g))return D(g);E=l,d=!1,t.emit("dragChecked")}if(S)return E=l;$(g);var s=function(b){if(h===-1/0&&m===1/0)return b;var c=t.track.details,y=c.length,I=c.position,A=Z(b,h-I,m-I);if(y===0)return 0;if(!t.options.rubberband)return A;if(I<=m&&I>=h||I<h&&e>0||I>m&&e<0)return b;var q=(I<h?I-h:I-m)/y,F=p*y,J=Math.abs(q*F),G=Math.max(0,1-J/a*2);return G*G*b}(k(E-l)/p*o);e=X(s);var n=t.track.details.position;(n>h&&n<m||n===h&&e>0||n===m&&e<0)&&B(g),z+=s,!M&&Math.abs(z*p)>5&&(M=!0),t.track.add(s),E=l,t.emit("dragged")}}function L(g){!r&&t.track.details&&t.track.details.length&&(z=0,r=!0,M=!1,d=!0,w=g.id,u(g),E=x(g),t.emit("dragStarted"))}function D(g){r&&w===g.idChanged&&(r=!1,t.emit("dragEnded"))}function u(g){var l=H(),s=l?g.y:g.x,n=l?g.x:g.y,b=C!==void 0&&v!==void 0&&Math.abs(v-n)<=Math.abs(C-s);return C=s,v=n,b}function x(g){return H()?g.y:g.x}function H(){return t.options.vertical}function U(){p=t.size,a=H()?window.innerHeight:window.innerWidth;var g=t.track.details;g&&(h=g.min,m=g.max)}function P(g){M&&(B(g),$(g))}function j(){if(f.purge(),t.options.drag&&!t.options.disabled){var g;g=t.options.dragSpeed||1,k=typeof g=="function"?g:function(s){return s*g},o=t.options.rtl?-1:1,U(),i=t.container,function(){var s="data-keen-slider-clickable";K("[".concat(s,"]:not([").concat(s,"=false])"),i).map(function(n){f.add(n,"dragstart",B),f.add(n,"mousedown",B),f.add(n,"touchstart",B)})}(),f.add(i,"dragstart",function(s){$(s)}),f.add(i,"click",P,{capture:!0}),f.input(i,"ksDragStart",L),f.input(i,"ksDrag",O),f.input(i,"ksDragEnd",D),f.input(i,"mousedown",L),f.input(i,"mousemove",O),f.input(i,"mouseleave",D),f.input(i,"mouseup",D),f.input(i,"touchstart",L,{passive:!0}),f.input(i,"touchmove",O,{passive:!1}),f.input(i,"touchend",D),f.input(i,"touchcancel",D),f.add(window,"wheel",function(s){r&&$(s)});var l="data-keen-slider-scrollable";K("[".concat(l,"]:not([").concat(l,"=false])"),t.container).map(function(s){return function(n){var b;f.input(n,"touchstart",function(c){b=x(c),S=!0,T=!0},{passive:!0}),f.input(n,"touchmove",function(c){var y=H(),I=y?n.scrollHeight-n.clientHeight:n.scrollWidth-n.clientWidth,A=b-x(c),q=y?n.scrollTop:n.scrollLeft,F=y&&n.style.overflowY==="scroll"||!y&&n.style.overflowX==="scroll";if(b=x(c),(A<0&&q>0||A>0&&q<I)&&T&&F)return S=!0;T=!1,$(c),S=!1}),f.input(n,"touchend",function(){S=!1})}(s)})}}t.on("updated",U),t.on("optionsChanged",j),t.on("created",j),t.on("destroyed",f.purge)}function ht(t){var i,e,o=null;function p(C,v,T){t.animator.active?r(C,v,T):requestAnimationFrame(function(){return r(C,v,T)})}function a(){p(!1,!1,e)}function r(C,v,T){var S=0,h=t.size,m=t.track.details;if(m&&i){var f=m.slides;i.forEach(function(O,L){if(C)!o&&v&&w(O,null,T),d(O,null,T);else{if(!f[L])return;var D=f[L].size*h;!o&&v&&w(O,D,T),d(O,f[L].distance*h-S,T),S+=D}})}}function k(C){return t.options.renderMode==="performance"?Math.round(C):C}function w(C,v,T){var S=T?"height":"width";v!==null&&(v=k(v)+"px"),C.style["min-"+S]=v,C.style["max-"+S]=v}function d(C,v,T){if(v!==null){v=k(v);var S=T?v:0;v="translate3d(".concat(T?0:v,"px, ").concat(S,"px, 0)")}C.style.transform=v,C.style["-webkit-transform"]=v}function E(){i&&(r(!0,!0,e),i=null),t.on("detailsChanged",a,!0)}function z(){p(!1,!0,e)}function M(){E(),e=t.options.vertical,t.options.disabled||t.options.renderMode==="custom"||(o=R(t.options.slides,"perView",null)==="auto",t.on("detailsChanged",a),(i=t.slides).length&&z())}t.on("created",M),t.on("optionsChanged",M),t.on("beforeOptionsChanged",function(){E()}),t.on("updated",z),t.on("destroyed",E)}function mt(t,i){return function(e){var o,p,a,r,k,w=st();function d(u){var x;Q(e.container,"reverse",(x=e.container,window.getComputedStyle(x,null).getPropertyValue("direction")!=="rtl"||u?null:"")),Q(e.container,"v",e.options.vertical&&!u?"":null),Q(e.container,"disabled",e.options.disabled&&!u?"":null)}function E(){z()&&S()}function z(){var u=null;if(r.forEach(function(H){H.matches&&(u=H.__media)}),u===o)return!1;o||e.emit("beforeOptionsChanged"),o=u;var x=u?a.breakpoints[u]:a;return e.options=V(V({},a),x),d(),L(),D(),m(),!0}function M(u){var x=ot(u);return(e.options.vertical?x.height:x.width)/e.size||1}function C(){return e.options.trackConfig.length}function v(u){for(var x in o=!1,a=V(V({},i),u),w.purge(),p=e.size,r=[],a.breakpoints||[]){var H=window.matchMedia(x);H.__media=x,r.push(H),w.add(H,"change",E)}w.add(window,"orientationchange",O),w.add(window,"resize",f),z()}function T(u){e.animator.stop();var x=e.track.details;e.track.init(u??(x?x.abs:0))}function S(u){T(u),e.emit("optionsChanged")}function h(u,x){if(u)return v(u),void S(x);L(),D();var H=C();m(),C()!==H?S(x):T(x),e.emit("updated")}function m(){var u=e.options.slides;if(typeof u=="function")return e.options.trackConfig=u(e.size,e.slides);for(var x=e.slides,H=x.length,U=typeof u=="number"?u:R(u,"number",H,!0),P=[],j=R(u,"perView",1,!0),g=R(u,"spacing",0,!0)/e.size||0,l=j==="auto"?g:g/j,s=R(u,"origin","auto"),n=0,b=0;b<U;b++){var c=j==="auto"?M(x[b]):1/j-g+l,y=s==="center"?.5-c/2:s==="auto"?0:s;P.push({origin:y,size:c,spacing:g}),n+=c}if(n+=g*(U-1),s==="auto"&&!e.options.loop&&j!==1){var I=0;P.map(function(A){var q=n-I;return I+=A.size+g,q>=1||(A.origin=1-q-(n>1?0:1-n)),A})}e.options.trackConfig=P}function f(){L();var u=e.size;e.options.disabled||u===p||(p=u,h())}function O(){f(),setTimeout(f,500),setTimeout(f,2e3)}function L(){var u=ot(e.container);e.size=(e.options.vertical?u.height:u.width)||1}function D(){e.slides=K(e.options.selector,e.container)}e.container=(k=K(t,document)).length?k[0]:null,e.destroy=function(){w.purge(),e.emit("destroyed"),d(!0)},e.prev=function(){e.moveToIdx(e.track.details.abs-1,!0)},e.next=function(){e.moveToIdx(e.track.details.abs+1,!0)},e.update=h,v(e.options)}}var gt=function(t,i,e){try{return function(o,p){var a,r={};return a={emit:function(k){r[k]&&r[k].forEach(function(d){d(a)});var w=a.options&&a.options[k];w&&w(a)},moveToIdx:function(k,w,d){var E=a.track.idxToDist(k,w);if(E){var z=a.options.defaultAnimation;a.animator.start([{distance:E,duration:R(d||z,"duration",500),easing:R(d||z,"easing",function(M){return 1+--M*M*M*M*M})}])}},on:function(k,w,d){d===void 0&&(d=!1),r[k]||(r[k]=[]);var E=r[k].indexOf(w);E>-1?d&&delete r[k][E]:d||r[k].push(w)},options:o},function(){if(a.track=ft(a),a.animator=lt(a),p)for(var k=0,w=p;k<w.length;k++)(0,w[k])(a);a.track.init(a.options.initial||0),a.emit("created")}(),a}(i,ut([mt(t,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),ht,vt,pt],e||[],!0))}catch(o){console.error(o)}};let bt=class extends window.HTMLElement{constructor(){super(),this.slider=this.querySelector("[data-upsell-slider]"),this.next=this.querySelector("[data-next]"),this.prev=this.querySelector("[data-prev]");var i=new gt(this.slider,{loop:!0,created:()=>{console.log("created")}});this.next.addEventListener("click",()=>{i.next()}),this.prev.addEventListener("click",()=>{i.prev()}),document.addEventListener("cart-upsell:update",(function(){console.log("keen-update, upsell"),i.update()}).bind(this)),document.addEventListener("cart:open",(function(){console.log("keen-update"),i.update()}).bind(this))}async submitHandler(i){i.preventDefault(),this.button.classList.add("animate-pulse");const e=(o="javascript")=>({method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:`application/${o}`},body:new FormData(this.form)});try{await fetch(`${window.routes.cart_add_url}`,e()),window.location=window.shopUrl+"/checkout"}catch(o){console.error(o)}}};class wt extends window.HTMLElement{constructor(){var i;super(),this.variantId=this.querySelector("[data-variant-id]").value,this.button=this.querySelector("[data-add-to-cart]"),(i=this==null?void 0:this.button)==null||i.addEventListener("click",this.submitHandler.bind(this))}async submitHandler(i){console.log("SUBMIT"),i.preventDefault();let e={items:[{id:parseInt(this.variantId),quantity:1}]};fetch(window.theme.routes.cartAdd,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(o=>(this.remove(),document.dispatchEvent(new CustomEvent("cart-upsell:update")),document.dispatchEvent(new CustomEvent("cart:build")),o.json())).catch(o=>{console.error("Error:",o)})}}window.customElements.define("cart-upsell-slider",bt);window.customElements.define("cart-upsell-item",wt);
